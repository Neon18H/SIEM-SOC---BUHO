{% extends 'base.html' %}
{% block content %}
<h3>Endpoints</h3>
<form class="row g-2 mb-3" method="get">
  <div class="col"><input class="form-control" name="org" placeholder="Org" value="{{ request.GET.org }}"></div>
  <div class="col"><input class="form-control" name="status" placeholder="status" value="{{ request.GET.status }}"></div>
  <div class="col"><input class="form-control" name="risk_min" placeholder="risk min" value="{{ request.GET.risk_min }}"></div>
  <div class="col"><input class="form-control" name="os" placeholder="os" value="{{ request.GET.os }}"></div>
  <div class="col-auto"><button class="btn btn-primary">Filtrar</button></div>
</form>
<table class="table table-striped table-dark">
  <thead><tr><th>Hostname</th><th>OS</th><th>IP</th><th>Status</th><th>Last Seen</th><th>Risk</th><th>Alerts 24h</th></tr></thead>
  <tbody>
  {% for a in agents %}
    <tr>
      <td><a href="/endpoints/{{ a.id }}/">{{ a.hostname }}</a></td>
      <td>{{ a.os }}</td>
      <td>{{ a.ip }}</td>
      <td>{{ a.status }}</td>
      <td>{{ a.last_seen|date:'Y-m-d H:i:s' }}</td>
      <td>{{ a.risk_score|default:0 }}</td>
      <td>{{ a.alerts_24h }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="7">Sin endpoints</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
